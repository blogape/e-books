{"remainingRequest":"/Users/chenzehua/Documents/work/vue-book/e-book/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/chenzehua/Documents/work/vue-book/e-book/src/components/ebook/EbookReader.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/chenzehua/Documents/work/vue-book/e-book/src/components/ebook/EbookReader.vue","mtime":1550026600901},{"path":"/Users/chenzehua/Documents/work/vue-book/e-book/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/chenzehua/Documents/work/vue-book/e-book/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/chenzehua/Documents/work/vue-book/e-book/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/chenzehua/Documents/work/vue-book/e-book/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n\nimport Epub from \"epubjs\";\nimport { mapGetters } from \"vuex\";\nimport { exists } from \"fs\";\n\nglobal.ePub = Epub;\n\nexport default {\n  computed: {\n    ...mapGetters([\"fileName\",\"menuVisible\"])\n  },\n  methods: {\n    prevPage() {\n      if (this.rendition) {\n        this.rendition.prev();\n      }\n    },\n    nextPage() {\n      if (this.rendition) {\n        this.rendition.next();\n      }\n    },\n\n    toggleTitleAndMenu() {\n      console.log('title');\n      console.log(this.$store.state.book.menuVisible);\n      this.$store.dispatch('setMenuVisible',!this.$store.state.book.menuVisible)\n    },\n\n    initEpub() {\n      const url =\n        \"http://192.168.1.80:9001/epub/\" +\n        this.$store.state.book.fileName +\n        \".epub\";\n      this.book = new Epub(url);\n      //   向ifram 绑定事件\n      this.rendition = this.book.renderTo(\"read\", {\n        width: innerWidth,\n        height: innerHeight,\n        method: \"default\"\n      });\n      /* 触摸开始*/\n      this.rendition.display();\n      this.rendition.on(\"touchstart\", event => {\n        /* 获取点击X坐标 */\n        this.touchStartX = event.changedTouches[0].clientX;\n        /* 获取点击Y坐标 */\n        this.touchStartY = event.changedTouches[0].clientY;\n        /* 获取长按时间 */\n        this.touchStartTime = event.timeStamp;\n      });\n      this.rendition.on(\"touchend\", event => {\n        const offseX = event.changedTouches[0].clientX - this.touchStartX;\n        const time = event.timeStamp - this.touchStartTime;\n        console.log(offseX, time);\n        if (time < 500 && offseX > 40) {\n          this.prevPage();\n        } else if (time < 500 && offseX < -40) {\n          this.nextPage();\n        } else {\n          this.toggleTitleAndMenu();\n        }\n        event.preventDefault();\n        event.stopPropagation();\n      });\n    }\n  },\n  mounted() {\n    console.log(this);\n    this.$store\n      .dispatch(\"setFileName\", this.$route.params.fileName.split(\"|\").join(\"/\"))\n      .then(() => {\n        this.initEpub();\n      });\n  }\n};\n",{"version":3,"sources":["EbookReader.vue"],"names":[],"mappings":";;;;;;;AAOA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"EbookReader.vue","sourceRoot":"src/components/ebook","sourcesContent":["<template>\n  <div class=\"ebook-reader\">\n    <div id=\"read\"></div>\n  </div>\n</template>\n\n<script>\nimport Epub from \"epubjs\";\nimport { mapGetters } from \"vuex\";\nimport { exists } from \"fs\";\n\nglobal.ePub = Epub;\n\nexport default {\n  computed: {\n    ...mapGetters([\"fileName\",\"menuVisible\"])\n  },\n  methods: {\n    prevPage() {\n      if (this.rendition) {\n        this.rendition.prev();\n      }\n    },\n    nextPage() {\n      if (this.rendition) {\n        this.rendition.next();\n      }\n    },\n\n    toggleTitleAndMenu() {\n      console.log('title');\n      console.log(this.$store.state.book.menuVisible);\n      this.$store.dispatch('setMenuVisible',!this.$store.state.book.menuVisible)\n    },\n\n    initEpub() {\n      const url =\n        \"http://192.168.1.80:9001/epub/\" +\n        this.$store.state.book.fileName +\n        \".epub\";\n      this.book = new Epub(url);\n      //   向ifram 绑定事件\n      this.rendition = this.book.renderTo(\"read\", {\n        width: innerWidth,\n        height: innerHeight,\n        method: \"default\"\n      });\n      /* 触摸开始*/\n      this.rendition.display();\n      this.rendition.on(\"touchstart\", event => {\n        /* 获取点击X坐标 */\n        this.touchStartX = event.changedTouches[0].clientX;\n        /* 获取点击Y坐标 */\n        this.touchStartY = event.changedTouches[0].clientY;\n        /* 获取长按时间 */\n        this.touchStartTime = event.timeStamp;\n      });\n      this.rendition.on(\"touchend\", event => {\n        const offseX = event.changedTouches[0].clientX - this.touchStartX;\n        const time = event.timeStamp - this.touchStartTime;\n        console.log(offseX, time);\n        if (time < 500 && offseX > 40) {\n          this.prevPage();\n        } else if (time < 500 && offseX < -40) {\n          this.nextPage();\n        } else {\n          this.toggleTitleAndMenu();\n        }\n        event.preventDefault();\n        event.stopPropagation();\n      });\n    }\n  },\n  mounted() {\n    console.log(this);\n    this.$store\n      .dispatch(\"setFileName\", this.$route.params.fileName.split(\"|\").join(\"/\"))\n      .then(() => {\n        this.initEpub();\n      });\n  }\n};\n</script>\n\n<style>\n</style>\n"]}]}